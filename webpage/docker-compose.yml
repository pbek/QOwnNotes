services:
  # Development server with VuePress 2 + Vuetify 3
  dev:
    image: node:22-alpine
    volumes:
      - .:/app
      - node_modules:/app/node_modules # Named volume for node_modules
    ports:
      - "8080:8080"
    working_dir: /app
    command: ["/bin/sh", "-c", "npm install --legacy-peer-deps && npm run dev"]
    environment:
      - NODE_ENV=development

  # Production build and serve
  web:
    # image: qownnotes-webpage:latest
    build: .
    container_name: qownnotes-webpage
    restart: always
    ports:
      - "8081:80"
    extra_hosts:
      - "qownnotes-api:127.0.0.1"

volumes:
  node_modules:
